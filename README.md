
# passgen.py — Генератор по памятке (пул S*, перец W, вплетение)

## Установка
```bash
chmod +x passgen.py
```

## Рекомендуемый безопасный запуск
Интерактивно ввести пул S* и перец W (ничего не светится в истории):
```bash
./passgen.py \
  --login john.doe@yandex \
  --domain yandex.ru \
  --year 1995 \
  --pool-size 4 \
  --ask-sstar-pool \
  --pepper-ask
```

Или ввести пул как S0 (будет построена S* по правилу вставки Q):
```bash
./passgen.py \
  --login john.doe@yandex \
  --domain yandex.ru \
  --year 1995 \
  --pool-size 4 \
  --ask-s0-pool \
  --pepper-ask
```

## Аргументы
- `--login` — логин (email или локальная часть).
- `--domain` — домен сайта.
- `--year` — год/версия (2–4 цифры).
- `--pool-size` — размер пула S* (3..8, по умолчанию 4).
- `--ask-sstar-pool` — безопасный ввод пула S* (каждая как есть).
- `--ask-s0-pool` — безопасный ввод пула S0 (каждая будет преобразована в S* по Q).
- `--pepper-ask` — безопасный ввод «перца» W (секретный сдвиг r).
- `--classic` — классическая сборка без вплетения (иначе используется интерливинг).
- НЕБЕЗОПАСНЫЕ альтернативы (для автоматизации, если очень нужно):
  - `--sstar-pool "S1;S2;S3"` — пул S* через точку с запятой;
  - `--pepper "слово"` — перец W в явном виде;
  - Переменные окружения: `PASSGEN_SSTAR_POOL`, `PASSGEN_PEPPER`, `PASSGEN_Q_SEQ`, `PASSGEN_P_SEQ`.

## Алгоритм (коротко)
1. `K = key(domain)`, `T = tag4(K)`, `T^ = cap_1_3(T)`, `L2 = len(K) % 100`, `Y2 = year[-2:]`.
2. `U = tag4(letters(login))`, `U^ = cap_1_3(U)`.
3. `r = Σpos(W) mod N`; индекс пула: `i = (Σpos(letters(K)) + Σpos(letters(login)) + r) mod N`.
4. `SYM`: `idx = (Σpos(T) + Σpos(U) + Σdigits(year) + r) mod 10`, символ `P[idx]`.
5. Вплетение: `d1=(idx%4)+2`, `d2=(Σdigits(year)%3)+2`, `S* -> S1,S2,S3`.
6. Пароль: `SYM + S1 + T^ + S2 + L2 + S3 + Y2 + U^` (или классика).

## Примечания
- Для сервисов, где запрещены спецсимволы, можно временно перейти на `--classic` и заменить SYM на двузначное число (адаптация на месте).
- Храните S* и W только в голове. Включайте 2FA/FIDO2 на критичных сервисах.
